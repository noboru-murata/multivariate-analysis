<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>数学的準備</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/fonts/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/mycourse.css"/>
<link rel="stylesheet" href="./reveal.js/plugin/highlight/zenburn.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">数学的準備</h1>
</div>
<div class="talk-subtitle">
    <p>多変量解析 - 第2講</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  </p>
</div>

</section>

<section>
<section id="slide-org45e1f90">
<h2 id="org45e1f90">講義の内容</h2>
<ul>
<li>確率
<ul>
<li>確率分布</li>
<li>確率質量関数・確率密度関数</li>
<li>正規分布 (\(\chi^2\)-分布，\(t\)-分布，\(F\)-分布 )</li>

</ul></li>
<li>統計
<ul>
<li>統計量 (標本平均，不偏分散・共分散，相関係数)</li>
<li>最尤法 (尤度関数)</li>
<li>Bayes の定理</li>

</ul></li>
<li>関数の微分
<ul>
<li>ベクトルによる微分</li>
<li>行列による微分</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-org1735feb">
<h2 id="org1735feb">確率</h2>
<div class="outline-text-2" id="text-org1735feb">
</div>
</section>
<section id="slide-org969a768">
<h3 id="org969a768">確率分布</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
注目する事象(見本空間の部分集合)に対して，
それが起きる確率(区間 \([0,1]\) の実数)を返す関数
</p>
<div>
\begin{equation}
  P(\text{事象})=\text{確率値}
\end{equation}

</div>

<p>
を <b>確率分布</b> という．
</p>
</blockquote></li>
<li>実用上重要な分布
<ul>
<li>離散分布</li>
<li>連続分布 (絶対連続な分布)</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgc3164c7">
<h3 id="orgc3164c7">確率質量関数</h3>
<ul>
<li><p>
離散分布の場合
</p>
<blockquote>
<p>
1つの見本点 \(x\) からなる事象を \(A=\{x\}\) とする．
事象 \(A\) (根元事象という)の起きる確率
</p>
<div>
\begin{equation}
  P(A=\{x\})= p(x)
\end{equation}

</div>

<p>
を表す関数 \(p\) を <b>確率質量関数</b> という．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgc98ee0a">
<h3 id="orgc98ee0a">確率密度関数</h3>
<ul>
<li><p>
連続分布の場合
</p>
<blockquote>
<p>
事象 \(A\) が起きる確率は
<b>確率密度関数</b> \(p\) の積分
</p>
<div>
\begin{equation}
  P(A)=\int_A p(x)dx
\end{equation}

</div>

<p>
で表される．
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
事象 \(A\) が十分小さな集合の場合
</p>
<blockquote>
<p>
\(A\) に含まれる適当な点を \(x\) とし，
\(A\) の大きさ(考える空間により体積や面積に相当)を
\(|A|\) と書くことにすれば，
事象 \(A\) の起きる確率を
</p>
<div>
\begin{equation}
  P(A)=p(x)\cdot|A|
\end{equation}

</div>

<p>
で近似することができる．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org3c9ae13">
<h3 id="org3c9ae13">正規分布 (normal/Gaussian distribution)</h3>
<div class="leftcol" id="orge78d9f8">

<div id="org716cfea" class="figure">
<p><img src="figs/pdf_norm.png" alt="pdf_norm.png" width="100%" />
</p>
<p><span class="figure-number">Figure 1: </span>正規分布 (平均\(0\),分散\(1\))</p>
</div>

</div>
<div class="rightcol" id="orga23773e">
<blockquote>
<ul>
<li>見本空間: \((-\infty,\infty)\)</li>
<li>母数: 平均 \(\mu\), 分散 \(\sigma^{2}\)</li>
<li><p>
密度関数:
</p>
<div>
\begin{equation}
  f(x)
  =
  \frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\mu)^{2}}{2\sigma^{2}}}
\end{equation}

</div></li>

<li>備考: \(\mu=0,\sigma=1\) のとき
<b>標準正規分布</b> と呼ぶ．</li>

</ul>
</blockquote>

</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org837ca48">
<h3 id="org837ca48">多次元正規分布</h3>
<ul>
<li>見本空間: \(\mathbb{R}^{p}\)</li>
<li>母数: 平均 \(\boldsymbol{\mu}\), 分散共分散行列 \(\Sigma\)</li>
<li><p>
密度関数:
</p>
<blockquote>
<div>
\begin{equation}
  f(\boldsymbol{x})
  =\frac{1}{\sqrt{(2\pi)^p|\Sigma|}}
  e^{-\frac{1}{2}(\boldsymbol{x}-\boldsymbol{\mu})^{\mathsf{T}}
    \Sigma^{-1}(\boldsymbol{x}-\boldsymbol{\mu})}
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org79dfe13">
<h3 id="org79dfe13">正規分布の特徴付け</h3>
<ul>
<li>性質
<ul>
<li>さまざまな誤差の集積は正規分布となる(中心極限定理)</li>
<li>同じ分散(ばらつき)を持つ分布の中で最も情報量(エントロピー)が大きい</li>

</ul></li>
<li>用途
<ul>
<li>誤差の分布に関する知識がないときには正規分布だと考えておくと安全である</li>
<li>多変量解析の多くの手法は誤差の分布に関して正規性を仮定して導出する</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgc9e49c4">
<h3 id="orgc9e49c4">\(\chi^{2}\)-分布 (\(\chi^{2}\)-distribution)</h3>
<div class="leftcol" id="orgcfa2233">

<div id="orge49fa0b" class="figure">
<p><img src="figs/pdf_chisq.png" alt="pdf_chisq.png" width="100%" />
</p>
<p><span class="figure-number">Figure 2: </span>\(\chi^{2}\)-分布 (自由度\(3\))</p>
</div>

</div>
<div class="rightcol" id="orgbfc286f">
<blockquote>
<ul>
<li>見本空間: \([0,\infty)\)</li>
<li>母数: 自由度 \(\nu\)</li>
<li><p>
密度関数:
</p>
<div>
\begin{align}
  f(x)
  &=
    \frac{1}{2^{\nu/2}\Gamma(\frac{\nu}{2})}x^{\nu/2-1}e^{-x/2}\\
  &\qquad\Gamma(z)=\int_0^\infty e^{-t}t^{z-1}dt
\end{align}

</div></li>

<li>備考: 標準正規分布に従う独立な確率変数の2乗和の分布</li>

</ul>
</blockquote>

</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgfec77da">
<h3 id="orgfec77da">\(\chi^{2}\)-分布の特徴付け</h3>
<ul>
<li>性質
<ul>
<li><p>
標準正規分布に従う独立な確率変数の2乗和の分布
</p>
<blockquote>
<div>
\begin{align}
  Z&=\sum_{i=1}^{\nu}X_{i}^{2}
     \sim \chi^{2}(\nu)
     \quad\text{(自由度\(\nu\)の\(\chi^{2}\)-分布)}\\
   &X_{i}\sim \mathcal{N}(0,1)\;(i=1,\dotsc,\nu)
     \quad\text{(標準正規分布)}
\end{align}

</div>
</blockquote></li>
<li>正規分布に従う確率変数の不偏分散は
\(\chi^{2}\)-分布に従う確率変数の定数倍となる</li>

</ul></li>
<li>用途
<ul>
<li>分散の大きさに関する検定に用いられる</li>
<li>独立性検定・適合度検定など様々な検定でも用いられる</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org1f5b905">
<h3 id="org1f5b905">\(t\)-分布 (Student&rsquo;s \(t\)-distribution)</h3>
<div class="leftcol" id="org640a244">

<div id="org5388024" class="figure">
<p><img src="figs/pdf_t.png" alt="pdf_t.png" width="100%" />
</p>
<p><span class="figure-number">Figure 3: </span>\(t\)-分布 (自由度\(3\))</p>
</div>

</div>
<div class="rightcol" id="org40131fe">
<blockquote>
<ul>
<li>見本空間: \((-\infty,\infty)\)</li>
<li>母数: 自由度 \(\nu\)</li>
<li><p>
密度関数:
</p>
<div>
\begin{equation}
  f(x)=
  \frac{\Gamma\left(\frac{\nu+1}{2}\right)}
  {\sqrt{\nu\pi}\Gamma\left(\frac{\nu}{2}\right)}
  \left(1+\frac{x^{2}}{\nu}\right)^{-\frac{1}{2}(\nu+1)}
\end{equation}

</div></li>

<li>備考: 標準正規分布と
\(\chi^{2}\)-分布に従う独立な
確率変数の比の分布</li>

</ul>
</blockquote>

</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org4600294">
<h3 id="org4600294">\(t\)-分布の特徴付け</h3>
<ul>
<li>性質
<ul>
<li><p>
標準正規分布と \(\chi^{2}\)-分布に従う独立な確率変数の比の分布
</p>
<blockquote>
<div>
\begin{align}
  Z&=\frac{X}{\sqrt{Y/\nu}}
     \sim \mathcal{T}(\nu)
     \quad\text{(自由度\(\nu\)の\(t\)-分布)}\\
   &X\sim \mathcal{N}(0,1),
     \quad
     Y\sim \chi^{2}(\nu)
\end{align}

</div>
</blockquote></li>
<li>正規分布に従う確率変数の標本平均と真の値の差は
不偏分散で正規化すると\(t\)-分布に従う確率変数となる</li>

</ul></li>
<li>用途
<ul>
<li>平均値を推定する問題の検定に利用される</li>
<li>信頼区間の構成に利用される</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgda2ce5a">
<h3 id="orgda2ce5a">\(F\)-分布 (\(F\)-distribution)</h3>
<div class="leftcol" id="org07fb280">

<div id="org0d079a3" class="figure">
<p><img src="figs/pdf_F.png" alt="pdf_F.png" width="100%" />
</p>
<p><span class="figure-number">Figure 4: </span>\(F\)-分布 (自由度\(3,5\))</p>
</div>

</div>
<div class="rightcol" id="orgfd31f46">
<blockquote>
<ul>
<li>見本空間: \([0,\infty)\)</li>
<li>母数: 自由度 \(\nu_{1},\nu_{2}\)</li>
<li><p>
密度関数:
</p>
<div>
\begin{equation}
  f(x)
  =
  \frac{(\nu_{1}/\nu_{2})^{\nu_{1}/2}}{B(\nu_{1}/2,\nu_{2}/2)}
  \frac{x^{\nu_{1}/2-1}}{(1+\nu_{1}x/\nu_{2})^{(\nu_{1}+\nu_{2})/2}}
\end{equation}

</div></li>

<li>備考: \(\chi^{2}\)-分布に従う独立な確率変数の比の分布</li>

</ul>
</blockquote>

</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org1f471dd">
<h3 id="org1f471dd">\(F\)-分布の特徴付け</h3>
<ul>
<li>性質
<ul>
<li><p>
\(\chi^{2}\)-分布に従う独立な確率変数の比の分布
</p>
<blockquote>
<div>
\begin{align}
  Z&=\frac{Y_{1}/\nu_{1}}{Y_{2}/\nu_{2}}
     \sim \mathcal{F}(\nu_{1},\nu_{2})
     \quad\text{(自由度\(\nu_{1},\nu_{2}\)の\(F\)-分布)}\\
   &Y_{i}\sim \chi^{2}(\nu_{i})\;(i=1,2)
\end{align}

</div>
</blockquote></li>
<li>正規分布に従う確率変数の2つの独立な標本の不偏分散の比は
\(F\)-分布に従う確率変数となる</li>

</ul></li>
<li>用途
<ul>
<li>分散を推定する問題の検定に利用される</li>
<li>分散の信頼区間の構成に利用される</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-org2ca0425" data-background="#fef4f4">
<h2 id="org2ca0425">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orge9f2c6e" data-background="#fef4f4">
<h3 id="orge9f2c6e">問題</h3>
<ul>
<li><p>
標準正規分布の密度関数
</p>
<blockquote>
<div>
\begin{equation}
  f(x)
  =
  \frac{1}{\sqrt{2\pi}}e^{-\frac{x^{2}}{2}}
\end{equation}

</div>
</blockquote>
<p>
を\(\mathbb{R}\)上で積分すると
1となることを確かめよ
</p></li>
<li>標準正規分布に従う確率変数を\(X\)とする．
\(X\)が
0付近の値をとる確率と
1付近の値をとる確率の比を求めよ</li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-orgda1c5b8">
<h2 id="orgda1c5b8">統計</h2>
<div class="outline-text-2" id="text-orgda1c5b8">
</div>
</section>
<section id="slide-org485ee6d">
<h3 id="org485ee6d">記述統計量</h3>
<ul>
<li><b>記述統計量</b> : (または要約統計量・基本統計量)
<ul>
<li>データを簡潔に要約して表すための統計値</li>
<li>その集団全体の特徴を表す重要な指標</li>

</ul></li>
<li>一般に確率分布は未知</li>
<li><p>
手に入る少数のサンプル(観測データ)から <b>推定</b> 
</p>
<blockquote>
<div>
\begin{equation}
  X_1,X_2,\dots,X_n
\end{equation}

</div>
</blockquote></li>
<li>真の値と観測データによる推定には差が存在</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org4f83c19">
<h3 id="org4f83c19">平均</h3>
<ul>
<li>データの代表値を表す記述統計量</li>
<li><p>
<b>平均</b> (mean):
</p>
<blockquote>
<div>
\begin{equation}
  \mu=\mathbb{E}[X]
  =
  \begin{cases}
    \sum_{x\in\Omega} x p(x), &\text{(離散分布の場合)}\\
    \int_{x\in\Omega} x p(x)dx, &\text{(連続分布の場合)}
  \end{cases}
\end{equation}

</div>
</blockquote></li>
<li><p>
<b>標本平均</b> (sample mean):
</p>
<blockquote>
<div>
\begin{equation}
  \bar{X}
  =\frac{1}{n}\sum_{i=1}^{n}X_{i}
  =\frac{X_{1}+\dotsb+X_{n}}{n}
  % =\frac{X_1+X_2+\cdots+X_n}{n}
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org1e1246e">
<h3 id="org1e1246e">分散</h3>
<ul>
<li>データのばらつき具合を表す記述統計量</li>
<li><p>
<b>分散</b> (variance):
</p>
<blockquote>
<div>
\begin{equation}
  \mathrm{Var}(X)=\sigma^{2}=\mathbb{E}[(X-\mu)^{2}]
\end{equation}

</div>
</blockquote></li>
<li><p>
<b>標本分散</b> (sample variance):
</p>
<blockquote>
<div>
\begin{equation}
  S^{2}
  =\frac{1}{n}\sum_{i=1}^n(X_{i}-\bar{X})^{2}
  =\frac{(X_{1}-\bar{X})^{2}+\dotsb+(X_{n}-\bar{X})^{2}}{n}
  % =\frac{(X_1-\bar{X})^2+(X_2-\bar{X})^2+\cdots+(X_n-\bar{X})^2}{n}
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgd0ad9d2">
<h3 id="orgd0ad9d2">標本平均・分散の不偏性</h3>
<ul>
<li><p>
標本平均は \(\mu\) の <b>不偏推定量である</b>:
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}[\bar{X}]=\mu
\end{equation}

</div>
</blockquote></li>
<li><p>
標本分散は \(\sigma^2\) の <b>不偏推定量ではない</b>:
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}[S^2]=\frac{n-1}{n}\sigma^2
\end{equation}

</div>
</blockquote>
<ul>
<li>標本分散は平均的には真の分散を <b>過小推定</b> する</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org9c0cb3f">
<h3 id="org9c0cb3f">不偏分散</h3>
<ul>
<li>不偏性を担保した分散の推定量</li>
<li><p>
バイアス補正:
標本分散に \(n/(n-1)\) を乗じたもの
</p>
<blockquote>
<div>
\begin{equation}
  s^2=\frac{n}{n-1}S^2=\frac{1}{n-1}\sum_{i=1}^n(X_i-\bar{X})^2
\end{equation}

</div>
</blockquote>
<p>
は \(\sigma^2\) の不偏推定量となる
</p></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgbf104ab">
<h3 id="orgbf104ab">標準偏差</h3>
<ul>
<li><p>
<b>標準偏差</b> (standard deviation):
</p>
<blockquote>
<div>
\begin{equation}
  \sigma=\sqrt{\mathrm{Var}(X)}=(\mathbb{E}[(X-\mu)^{2}])^{1/2}
\end{equation}

</div>
</blockquote>
<ul>
<li>分散の平方根</li>

</ul></li>
<li><p>
<b>標本標準偏差</b> (sample standard deviation): 
</p>
<blockquote>
<div>
\begin{equation}
  \hat\sigma=s
\end{equation}

</div>
</blockquote>
<ul>
<li>通常, 不偏分散の平方根 \(s\) を用いる</li>

</ul></li>
<li>一般に \(s\) は標準偏差 \(\sigma\) の <b>不偏推定量ではない</b></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org79550d0">
<h3 id="org79550d0">標準化</h3>
<ul>
<li>複数データの分析のために単位や基準を揃える方法</li>
<li><p>
データ \(X_{1},X_{2},\dotsc,X_{n}\) の標準化:
</p>
<blockquote>
<div>
\begin{equation}
  Z_{i}=\frac{X_i-\bar{X}}{s}\quad(i=1,2,\dotsc,n)
\end{equation}

</div>
</blockquote>
<ul>
<li>\(s\) の代わりに \(S\) で割って定義する文献もある</li>

</ul></li>
<li>定義から \(Z_{1},Z_{2},\dotsc,Z_{n}\) の
標本平均は0, 不偏分散は1 に規格化される</li>
<li>\(Z_{i}\): <b>標準得点</b> あるいは <b>Zスコア</b></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgc705a8a">
<h3 id="orgc705a8a">偏差値</h3>
<ul>
<li>別の基準での標準化
<ul>
<li>教育学や心理学では, 平均50, 標準偏差10が好まれる</li>

</ul></li>
<li><p>
標本平均50, 標準偏差10に線形変換:
</p>
<blockquote>
<div>
\begin{equation}
  T_{i}=10Z_{i}+50\quad(i=1,\dotsc,n)
\end{equation}

</div>
</blockquote></li>
<li>\(T_{i}\):
<b>偏差値得点</b> あるいは <b>Tスコア</b></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org6bfe81b">
<h3 id="org6bfe81b">共分散</h3>
<ul>
<li>複数のデータ間の関係を知るための記述統計量</li>
<li><p>
<b>共分散</b> (covariance):
</p>
<blockquote>
<div>
\begin{equation}
  \mathrm{Cov}(X,Y)=\mathbb{E}[(X-\mathbb{E}[X])(Y-\mathbb{E}[Y])]
\end{equation}

</div>
</blockquote></li>
<li><p>
<b>標本共分散</b> (sample covariance): 
</p>
<blockquote>
<div>
\begin{equation}
  \mathrm{Cov}(X,Y)=\frac{\sum_{i=1}^n(X_i-\bar{X})(Y_i-\bar{Y})}{n-1}
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org415b281">
<h3 id="org415b281">相関</h3>
<ul>
<li>2種類のデータ間の比例関係の大きさ</li>
<li><p>
<b>相関</b> (correlation): 
</p>
<blockquote>
<div>
\begin{equation}
  \rho=\frac{\mathrm{Cov}(X,Y)}{\sqrt{\mathrm{Var}(X)\mathrm{Var}(Y)}}
\end{equation}

</div>
</blockquote></li>
<li><p>
<b>標本相関</b> (sample correlation): 
</p>
<blockquote>
<div>
\begin{equation}
  \rho=\frac{\sum_{i=1}^n(X_i-\bar{X})(Y_i-\bar{Y})}
  {\sqrt{\sum_{i=1}^n(X_i-\bar{X})^2}\sqrt{\sum_{i=1}^n(Y_i-\bar{Y})^2}}
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgd9057a9">
<h3 id="orgd9057a9">離散分布の尤度関数</h3>
<ul>
<li>\(X_1=x_1,X_2=x_2,\dots,X_n=x_n\) の同時確率
<ul>
<li>確率質量関数: \(f_{\boldsymbol{\theta}}(x)\)</li>
<li>確率質量関数のパラメタ: \(\boldsymbol{\theta}=\theta_1,\dots,\theta_p)\)</li>
<li><p>
独立な確率変数の同時確率:
</p>
<blockquote>
<div>
\begin{align}
  & P(X_1=x_1,X_2=x_2,\dots,X_n=x_n)
    =\prod_{i=1}^nP(X_i=x_i)\\
  &=
    \prod_{i=1}^nf_{\boldsymbol{\theta}}(x_i)
    =f_{\boldsymbol{\theta}}(x_1)\cdot
    f_{\boldsymbol{\theta}}(x_2)\cdots
    f_{\boldsymbol{\theta}}(x_n)
\end{align}

</div>
</blockquote></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
パラメタ \(\boldsymbol{\theta}\) に対して
観測データ \(X_1,X_2,\dots,X_n\) が得られる理論上の確率
</p>
<div>
\begin{equation}
  L(\boldsymbol{\theta})
  =\prod_{i=1}^nf_{\boldsymbol{\theta}}(X_i)
\end{equation}

</div>

<p>
を
\(\boldsymbol{\theta}\) の 
<b>尤度</b> と言い，
\(\boldsymbol{\theta}\) の関数 \(L\) を <b>尤度関数</b> と呼ぶ．
</p>
</blockquote>
<ul>
<li>観測データ 
\(X_1,X_2,\dots,X_n\) 
が現れるのにパラメタ 
\(\boldsymbol{\theta}\) 
の値がどの程度尤もらしいかを測る尺度となる</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org92e1c79">
<h3 id="org92e1c79">連続分布の尤度関数</h3>
<ul>
<li>\(x_1\leq X_1\leq x_1+\delta,\dotsc,x_n\leq X_n\leq x_n+\delta\) の同時確率
<ul>
<li>確率密度関数: \(f_{\boldsymbol{\theta}}(x)\)</li>
<li>確率密度関数のパラメタ: \(\boldsymbol{\theta}=(\theta_1,\dots,\theta_p)\)</li>
<li><p>
独立な確率変数の同時確率:
</p>
<blockquote>
<div>
\begin{align}
  & P(x_1\leq X_1\leq x_1+\delta,\dotsc,x_n\leq X_n\leq x_n+\delta)
    =\prod_{i=1}^nP(x_i\leq X_i\leq x_i+\delta)\\
  &\simeq
    \prod_{i=1}^nf_{\boldsymbol{\theta}}(x_i)\delta
    =f_{\boldsymbol{\theta}}(x_1)\cdot
    f_{\boldsymbol{\theta}}(x_2)\cdots
    f_{\boldsymbol{\theta}}(x_n)\delta^{n}
\end{align}

</div>
</blockquote></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
パラメタ \(\boldsymbol{\theta}\) に対して
観測データ \(X_1,X_2,\dots,X_n\) が得られる理論上の確率密度
</p>
<div>
\begin{equation}
  L(\boldsymbol{\theta})
  =\prod_{i=1}^nf_{\boldsymbol{\theta}}(X_i)
\end{equation}

</div>

<p>
を
\(\boldsymbol{\theta}\) の 
<b>尤度</b> と言い，
\(\boldsymbol{\theta}\) の関数 \(L\) を <b>尤度関数</b> と呼ぶ．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orge625526">
<h3 id="orge625526">最尤法</h3>
<ul>
<li><p>
最尤法: 
</p>
<blockquote>
<p>
観測データに対して「最も尤もらしい」パラメタ値を
\(\boldsymbol{\theta}\) の推定量として採用する方法
を最尤法という．
</p>
</blockquote></li>
<li><p>
最尤推定量:
</p>
<blockquote>
<p>
\(\Theta\) を尤度関数の定義域として，
尤度関数を最大とする  \(\hat{\boldsymbol{\theta}}\) 
</p>
<div>
\begin{equation}
  L(\hat{\boldsymbol{\theta}})
  =\max_{\boldsymbol{\theta}\in\Theta}L(\boldsymbol{\theta}).
\end{equation}

</div>

<p>
を 
\(\boldsymbol{\theta}\) 
の <b>最尤推定量</b> という．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org0314e1f">
<h3 id="org0314e1f">Bayesの定理 (基本形)</h3>
<ul>
<li><p>
定理
</p>
<blockquote>
<p>
条件付確率では次の等式が成り立つ．
</p>
<div>
\begin{equation}
  P(A|B)
  =\frac{P(A)P(B|A)}{P(B)}.
\end{equation}

</div>
</blockquote>
<ul>
<li>左辺と右辺で事象 \(A,B\) の役割が異なる</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgc32b15f">
<h3 id="orgc32b15f">Bayes の定理 (一般形)</h3>
<ul>
<li><p>
定理
</p>
<blockquote>
<p>
\(\Omega=A_1+A_2+\dotsb+A_n\) のとき
</p>
<div>
\begin{equation}
  P(A_i|B)
  =\frac{P(A_i)P(B|A_i)}{\sum_{k=1}^nP(A_k)P(B|A_k)}
\end{equation}

</div>

<p>
が成り立つ．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-orgd6ab653" data-background="#fef4f4">
<h2 id="orgd6ab653">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org33b81ae" data-background="#fef4f4">
<h3 id="org33b81ae">問題</h3>
<ul>
<li><p>
以下の問に答えなさい
</p>
<blockquote>
<p>
A先生は大の野球ファンで，
球団Hの勝敗で翌日の機嫌が左右されるとしよう．
よくよく調べた結果
</p>
<ul>
<li>球団Hが勝つと90%の確率で機嫌が良い</li>
<li>球団Hが負けると70%の確率で機嫌が悪い</li>

</ul>
<p>
が成り立っているとする．
</p>

<p>
また球団Hの勝率は現在のところ
</p>
<ul>
<li>球団Hは60%の確率で勝つ</li>
<li>球団Hは40%の確率で負ける</li>

</ul>
<p>
となっているとする．
</p>
</blockquote>
<ul>
<li>A先生が機嫌が良いときに球団Hが勝った確率は？</li>
<li>A先生が機嫌が悪いときに球団Hが負けた確率は？</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-orgfadaf59">
<h2 id="orgfadaf59">関数の微分</h2>
<div class="outline-text-2" id="text-orgfadaf59">
</div>
</section>
<section id="slide-org0798db7">
<h3 id="org0798db7">ベクトルによる微分</h3>
<ul>
<li><p>
\(d\) 次元ベクトル:
</p>
<blockquote>
<div>
\begin{equation}
  \boldsymbol{a}
  =\begin{pmatrix}
    a_1\\
    a_2\\
    \vdots\\
    a_d
  \end{pmatrix}
  =(a_1,a_2,\dotsc,a_d)^{\mathsf{T}}
\end{equation}

</div>
</blockquote></li>
<li><p>
ベクトル \(\boldsymbol{a}\) による関数 \(f(\boldsymbol{a})\) の微分:
</p>
<blockquote>
<div>
\begin{equation}
  \frac{\partial f}{\partial\boldsymbol{a}}
  =
  \left(
    \frac{\partial f}{\partial a_1},
    \frac{\partial f}{\partial a_2},
    \dotsc,
    \frac{\partial f}{\partial a_d}
  \right)^{\mathsf{T}}
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgc18ad04">
<h3 id="orgc18ad04">ベクトルによる微分 (例題)</h3>
<ul>
<li><p>
問題
</p>
<blockquote>
<p>
\(d\) 次元ベクトル \(\boldsymbol{a}\) と \(\boldsymbol{b}\)
を用いて定義される関数
\(f(\boldsymbol{a})=\boldsymbol{b}^{\mathsf{T}}\boldsymbol{a}=\boldsymbol{a}^{\mathsf{T}}\boldsymbol{b}\)
の \(\boldsymbol{a}\) による微分を求めよ．
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
解答例
</p>
<blockquote>
<p>
各成分で考えると以下のように計算される．
</p>
<div>
\begin{equation}
  \frac{\partial f}{\partial a_i}
  =\frac{\partial}{\partial a_i}
  \left(a_1b_1+\dotsb+a_ib_i+\dotsb+a_db_d\right)
  =b_i.
\end{equation}

</div>

<p>
したがって
</p>
<div>
\begin{equation}
  \frac{\partial f}{\partial\boldsymbol{a}}
  =
  \left(
    b_{1},
    b_{2},
    \dotsc,
    b_{d}
  \right)^{\mathsf{T}}
  =\boldsymbol{b}
\end{equation}

</div>

<p>
となる．
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
注意
</p>
<blockquote>
<div>
\begin{equation}
  \begin{aligned}
    \frac{\partial}{\partial\boldsymbol{a}}\left(\boldsymbol{a}^{\mathsf{T}}\boldsymbol{b}\right)
    &=\boldsymbol{b}\\
    \frac{\partial}{\partial\boldsymbol{a}}\left(\boldsymbol{b}^{\mathsf{T}}\boldsymbol{a}\right)
    &=(\boldsymbol{b}^{\mathsf{T}})^{\mathsf{T}}=\boldsymbol{b}
  \end{aligned}
\end{equation}

</div>

<p>
というルールがあることがわかる．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgb563408">
<h3 id="orgb563408">行列による微分</h3>
<ul>
<li><p>
\(d\times d\) 行列:
</p>
<blockquote>
<div>
\begin{equation}
  A
  =
  \begin{pmatrix}
    a_{11}&a_{12}&\dotsm&a_{1d}\\
    a_{21}&a_{22}&\dotsm&a_{2d}\\
    \vdots&&\ddots&\vdots\\
    a_{d1}&a_{d2}&\dotsm&a_{dd}
  \end{pmatrix}
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
行列 \(A\) による関数 \(f(A)\) の微分:
</p>
<blockquote>
<div>
\begin{equation}
  \frac{\partial f}{\partial A}
  =
  \begin{pmatrix}
    \frac{\partial f}{\partial a_{11}}
    &\frac{\partial f}{\partial a_{12}}&\dotsm
    &\frac{\partial f}{\partial a_{1d}}\\[3pt]
    \frac{\partial f}{\partial a_{21}}
    &\frac{\partial f}{\partial a_{22}}&\dotsm
    &\frac{\partial f}{\partial a_{2d}}\\[3pt]
    \vdots&&\ddots&\vdots\\
    \frac{\partial f}{\partial a_{d1}}
    &\frac{\partial f}{\partial a_{d2}}&\dotsm
    &\frac{\partial f}{\partial a_{dd}}
  \end{pmatrix}
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org7add623">
<h3 id="org7add623">行列による微分 (例題1)</h3>
<ul>
<li><p>
問題
</p>
<blockquote>
<p>
行列 \(A\) と \(d\) 次元ベクトル \(\boldsymbol{b}\)
を用いて定義される関数
</p>
<div>
\begin{equation}
  f(A)=\boldsymbol{b}^{\mathsf{T}}A\boldsymbol{b}=\sum_{i,j=1}^{d}b_ia_{ij}b_j
\end{equation}

</div>

<p>
の行列 \(A\) による微分を求めよ．
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
解答例
</p>
<blockquote>
<p>
成分で考えると
</p>
<div>
\begin{equation}
  \frac{\partial f}{\partial a_{ij}}
  = 
  \frac{\partial}{\partial a_{ij}}\sum_{i,j=1}^{d}b_ia_{ij}b_j
  =b_ib_j
\end{equation}

</div>

<p>
となるので，
</p>
<div>
\begin{equation}
  % \frac{\partial f}{\partial A}
  \frac{\partial}{\partial A}\boldsymbol{b}^{\mathsf{T}}A\boldsymbol{b}
  =
  \begin{pmatrix}
    b_1b_1&b_1b_2&\dots&b_1b_d\\
    b_2b_1&b_2b_2&\dots&b_2b_d\\
    \vdots&&\ddots&\vdots\\
    b_db_1&b_db_2&\dots&b_db_d
  \end{pmatrix}
  =\boldsymbol{b}\boldsymbol{b}^{\mathsf{T}}.
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org1ca9ccb">
<h3 id="org1ca9ccb">行列による微分 (例題2)</h3>
<ul>
<li><p>
問題
</p>
<blockquote>
<p>
\(d\times d\) 行列 \(A\) と \(B\)
を用いて定義される関数
</p>
<div>
\begin{equation}
  f(A)=\mathrm{tr} AB=\sum_{i,j=1}^{d}a_{ij}b_{ji}
\end{equation}

</div>

<p>
の行列 \(A\) による微分を求めよ．
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
解答例
</p>
<blockquote>
<p>
成分では
</p>
<div>
\begin{equation}
  \frac{\partial f}{\partial a_{ij}}
  =b_{ji} 
\end{equation}

</div>

<p>
となるので，
</p>
<div>
\begin{equation}
  % \frac{\partial f}{\partial A}
  \frac{\partial}{\partial A}\mathrm{tr} AB
  =
  \begin{pmatrix}
    b_{11}&b_{21}&\dots&b_{d1}\\
    b_{12}&b_{22}&\dots&b_{d2}\\
    \vdots&&\ddots&\vdots\\
    b_{1d}&b_{2d}&\dots&b_{dd}
  \end{pmatrix}
  =B^{\mathsf{T}}.
\end{equation}

</div>

<p>
と書くことができる．
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
注意1
</p>
<blockquote>
<p>
上の行列のトレースの性質から
</p>
<div>
\begin{align}
  &\frac{\partial}{\partial A}\mathrm{tr} AB=B^{\mathsf{T}}\\
  &\frac{\partial}{\partial A}\mathrm{tr} BA=B^{\mathsf{T}}\\
  &\frac{\partial}{\partial A}\mathrm{tr} A^{\mathsf{T}}B^{\mathsf{T}}=B^{\mathsf{T}}\\
  &\frac{\partial}{\partial A}\mathrm{tr} B^{\mathsf{T}}A^{\mathsf{T}}=B^{\mathsf{T}}
\end{align}

</div>

<p>
ことが容易に確かめられる．
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
注意2
</p>
<blockquote>
<div>
\begin{equation}
  \boldsymbol{b}^{\mathsf{T}}A\boldsymbol{b}
  =\mathrm{tr}\boldsymbol{b}^{\mathsf{T}}A\boldsymbol{b}=\mathrm{tr} A\boldsymbol{b}\boldsymbol{b}^{\mathsf{T}}
\end{equation}

</div>

<p>
となることから
</p>
<div>
\begin{equation}
  \frac{\partial}{\partial A}\boldsymbol{b}^{\mathsf{T}}A\boldsymbol{b}
  =
  \frac{\partial}{\partial A}\mathrm{tr} A\boldsymbol{b}\boldsymbol{b}^{\mathsf{T}}
  =\left(\boldsymbol{b}\boldsymbol{b}^{\mathsf{T}}\right)^{\mathsf{T}}
  =\boldsymbol{b}\boldsymbol{b}^{\mathsf{T}}
\end{equation}

</div>

<p>
となり，2つの例での計算結果が矛盾しないことが確かめられる．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org4462ea4" data-background="#fef4f4">
<h2 id="org4462ea4">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgb0ea6b5" data-background="#fef4f4">
<h3 id="orgb0ea6b5">問題</h3>
<ul>
<li><p>
行列(正方行列に限らない)のトレースに関して
</p>
<div>
\begin{equation}
  \mathrm{tr} AB
  =\mathrm{tr} B^{\mathsf{T}}A^{\mathsf{T}}
  =\mathrm{tr} BA
  =\mathrm{tr} A^{\mathsf{T}}B^{\mathsf{T}}
\end{equation}

</div>

<p>
が成り立つことを示せ
</p></li>
<li>\(d\) 次元ベクトル \(\boldsymbol{a}\) と
\(d\times d\) 行列 \(A\)
で定義される関数
\(f(\boldsymbol{a})=\boldsymbol{a}^{\mathsf{T}}A\boldsymbol{a}\)
のベクトル \(\boldsymbol{a}\) による微分を求めよ</li>
<li>行列 \(A\) の行列式を \(|A|\) と書くとき
行列 \(A\) による行列式 \(|A|\) の微分を求めよ
<ul>
<li>ヒント: 余因子展開を利用すると容易に求められる</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-org9b4d607">
<h2 id="org9b4d607">次週の予定</h2>
<ul>
<li><b>第1日: 回帰モデルの考え方と推定</b></li>
<li>第2日: モデルの評価</li>
<li>第3日: モデルによる予測と発展的なモデル</li>

</ul>
<div class="slide-footer"><br></div>
</div>
</div>
<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/search/search.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script src="./reveal.js/plugin/highlight/highlight.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,
overview: true,

transition: 'fade',
transitionSpeed: 'default',
spotlight: { size: 90, initialPresentationMode: false }, chalkboard: { toggleChalkboardButton: { left: '80px' }, toggleNotesButton: { left: '130px'}}, keyboard: { 69: function() { RevealChalkboard.toggleNotesCanvas() }, 87: function() { RevealChalkboard.toggleChalkboard() }, 67: function() { RevealChalkboard.clear() }, 82: function() { RevealChalkboard.reset() }, 68: function() { RevealChalkboard.download() }, 88: function() { RevealChalkboard.colorNext() }, 89: function() { RevealChalkboard.colorPrev() }, 84: function() { RevealSpotlight.toggleSpotlight() }, 81: function() { RevealSpotlight.togglePresentationMode()}},

// Plugins with reveal.js 4.x
plugins: [ RevealNotes, RevealSearch, RevealZoom, RevealHighlight ],

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/menu/menu.js'},
{ src: './reveal.js/plugin/chalkboard/chalkboard.js'},
{ src: './reveal.js/plugin/spotlight/spotlight.js'}]

});
</script>
</body>
</html>

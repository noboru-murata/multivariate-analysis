<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>判別分析</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/fonts/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/mycourse.css"/>
<link rel="stylesheet" href="./reveal.js/plugin/highlight/zenburn.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">判別分析</h1>
</div>
<div class="talk-subtitle">
    <p>分析の評価</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  </p>
</div>

</section>

<section>
<section id="slide-org35ae822">
<h2 id="org35ae822">判別分析の復習</h2>
<div class="outline-text-2" id="text-org35ae822">
</div>
</section>
<section id="slide-org3be9cce">
<h3 id="org3be9cce">判別分析</h3>
<ul>
<li>個体の特徴量から
その個体の属するクラスを予測する関係式を構成</li>
<li><b>事前確率</b> : \(\pi_k=P(Y=k)\) (prior probability)
<ul>
<li>\(X=\boldsymbol{x}\) が与えられる前に予測されるクラス</li>

</ul></li>
<li><b>事後確率</b> : \(p_k(\boldsymbol{x})\) (posterior probability)
<ul>
<li><p>
\(X=\boldsymbol{x}\) が与えられた後に予測されるクラス
</p>
<blockquote>
<div>
\begin{equation}
  p_k(\boldsymbol{x})=P(Y=k|X=\boldsymbol{x})
\end{equation}

</div>
</blockquote></li>
<li>所属する確率が最も高いクラスに個体を分類</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org1fa7d8a">
<h3 id="org1fa7d8a">判別関数</h3>
<ul>
<li>判別の手続き
<ul>
<li>説明変数 \(X=\boldsymbol{x}\) の取得</li>
<li>事後確率 \(p_k(\boldsymbol{x})\) の計算</li>
<li>事後確率最大のクラスにデータを分類</li>

</ul></li>
<li><p>
<b>判別関数</b> : \(\delta_k(\boldsymbol{x})\) (\(k=1,\dots,K\))
</p>
<blockquote>
<div>
\begin{equation}
  p_k(\boldsymbol{x}) 
  < 
  p_l(\boldsymbol{x})
  \Leftrightarrow
  \delta_k(\boldsymbol{x})
  <
  \delta_l(\boldsymbol{x})
\end{equation}

</div>
</blockquote>
<p>
事後確率の順序を保存する計算しやすい関数
</p></li>
<li>判別関数 \(\delta_k(\boldsymbol{x})\) を最大化するようなクラス \(k\) に分類</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgc75ac17">
<h3 id="orgc75ac17">線形判別</h3>
<ul>
<li>\(f_k(\boldsymbol{x})\) の仮定
<ul>
<li>\(q\) 変量正規分布の密度関数</li>
<li>平均ベクトル \(\boldsymbol{\mu}_k\) : クラスごとに異なる</li>
<li><p>
共分散行列 \(\Sigma\) : <b>すべてのクラスで共通</b>
</p>
<blockquote>
<div>
\begin{equation}
  f_k(\boldsymbol{x})
  =
  \frac{1}{(2\pi)^{q/2}\sqrt{\det\Sigma}}
  \exp\left(-\frac{1}{2}(\boldsymbol{x}-\boldsymbol{\mu}_k)^{\mathsf{T}}
    \Sigma^{-1}(\boldsymbol{x}-\boldsymbol{\mu}_k)\right)
\end{equation}

</div>
</blockquote></li>

</ul></li>
<li><p>
線形判別関数 : \(\boldsymbol{x}\) の1次式
</p>

<blockquote>
<div>
\begin{equation}
  \delta_k(\boldsymbol{x})
  =
  \boldsymbol{x}^{\mathsf{T}}\Sigma^{-1}\boldsymbol{\mu}_k
  -\frac{1}{2}\boldsymbol{\mu}_k^{\mathsf{T}}\Sigma^{-1}\boldsymbol{\mu}_k
  +\log\pi_k
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org5ffc7f8">
<h3 id="org5ffc7f8">2次判別</h3>
<ul>
<li>\(f_k(\boldsymbol{x})\) の仮定
<ul>
<li>\(q\) 変量正規分布の密度関数</li>
<li>平均ベクトル \(\boldsymbol{\mu}_k\) : クラスごとに異なる</li>
<li><p>
共分散行列 \(\Sigma_k\) : <b>クラスごとに異なる</b>
</p>
<blockquote>
<div>
\begin{equation}
  f_k(\boldsymbol{x})
  =
  \frac{1}{(2\pi)^{q/2}\sqrt{\det\Sigma_k}}
  \exp\left(-\frac{1}{2}(\boldsymbol{x}-\boldsymbol{\mu}_k)^{\mathsf{T}}
    \Sigma_k^{-1}(\boldsymbol{x}-\boldsymbol{\mu}_k)\right)
\end{equation}

</div>
</blockquote></li>

</ul></li>
<li><p>
2次判別関数 : \(\boldsymbol{x}\) の2次式
</p>
<blockquote>
<div>
\begin{equation}
  \delta_k(\boldsymbol{x})
  =
  -\frac{1}{2}\det\Sigma_k
  -\frac{1}{2}(\boldsymbol{x}-\boldsymbol{\mu}_k)^{\mathsf{T}}
  \Sigma_k^{-1}(\boldsymbol{x}-\boldsymbol{\mu}_k)
  +\log\pi_k
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orga422ace">
<h3 id="orga422ace">Fisherの線形判別</h3>
<ul>
<li>新しい特徴量 \(Z=\boldsymbol{\alpha}^{\mathsf{T}} X\) を考える</li>
<li>良い \(Z\) の基準
<ul>
<li>クラス内では集まっているほど良い (\(\boldsymbol{\alpha}^{\mathsf{T}} W\boldsymbol{\alpha}\)は小)</li>
<li>クラス間では離れているほど良い (\(\boldsymbol{\alpha}^{\mathsf{T}} B\boldsymbol{\alpha}\)は大)</li>

</ul></li>
<li><p>
Fisherの基準
</p>
<blockquote>
<div>
\begin{equation}
  \text{maximize}\quad \boldsymbol{\alpha}^{\mathsf{T}} B\boldsymbol{\alpha}
  \quad\text{s.t.}\quad \boldsymbol{\alpha}^{\mathsf{T}} W\boldsymbol{\alpha}=\text{const.}
\end{equation}

</div>
</blockquote>
<ul>
<li>\(\boldsymbol{\alpha}\) は \(W^{-1}B\) の第1から第 \(K-1\) 固有ベクトル</li>
<li>判別方法: 特徴量の距離を用いる</li>
<li>\(d_{k}=\sum_{l=1}^{K-1}(\alpha_l^{\mathsf{T}}\boldsymbol{x}-\alpha_l^{\mathsf{T}}\mu_k)^2\) 
が最小のとなるクラス \(k\) に判別</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-orgc3c0f13">
<h2 id="orgc3c0f13">2値判別分析の評価</h2>
<div class="outline-text-2" id="text-orgc3c0f13">
</div>
</section>
<section id="slide-org953f371">
<h3 id="org953f371">誤り率</h3>
<ul>
<li><p>
単純な誤り
</p>
<blockquote>
<div>
\begin{equation}
  \text{(誤り率)}
  =\frac{\text{(誤って判別されたデータ数)}}
  {\text{(全データ数)}}
\end{equation}

</div>
</blockquote></li>
<li>判別したいラベル : 陽性 (positive)
<ul>
<li><b>真陽性</b> : 正しく陽性と判定 (true positive; TP)</li>
<li><b>偽陽性</b> : 誤って陽性と判定 (false positive; FP) (<b>第I種過誤</b>)</li>
<li><b>偽陰性</b> : 誤って陰性と判定 (false negative; FN) (<b>第II種過誤</b>)</li>
<li><b>真陰性</b> : 正しく陰性と判定 (true negative; TN)</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org97a9197">
<h3 id="org97a9197">混同行列</h3>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">真値は陽性</th>
<th scope="col" class="org-left">真値は陰性</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">判別は陽性</td>
<td class="org-left">真陽性 (True Positive)</td>
<td class="org-left">偽陽性 (False Positive)</td>
</tr>

<tr>
<td class="org-left">判別は陰性</td>
<td class="org-left">偽陰性 (False Negative)</td>
<td class="org-left">真陰性 (True Negative)</td>
</tr>
</tbody>
</table>
<ul>
<li><b>confusion matrix</b></li>
<li>転置で書く流儀もあるので注意</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgf0d5e17">
<h3 id="orgf0d5e17">混同行列</h3>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">判別は陽性</th>
<th scope="col" class="org-left">判別は陰性</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">真値は陽性</td>
<td class="org-left">真陽性 (True Positive)</td>
<td class="org-left">偽陰性 (False Negative)</td>
</tr>

<tr>
<td class="org-left">真値は陰性</td>
<td class="org-left">偽陽性 (False Positive)</td>
<td class="org-left">真陰性 (True Negative)</td>
</tr>
</tbody>
</table>
<ul>
<li>パターン認識や機械学習で多く見られた書き方</li>
<li>誤差行列 (error matrix) とも呼ばれる</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org800c126">
<h3 id="org800c126">基本的な評価基準</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<div>
\begin{align}
  \text{(真陽性率)}
  &=\frac{TP}{TP+FN} \qquad\text{(true positive rate)}\\
  \text{(真陰性率)}
  &=\frac{TN}{FP+TN} \qquad\text{(true negative rate)}\\
  \text{(適合率)}
  &=\frac{TP}{TP+FP} \qquad\text{(precision)}\\
  \text{(正答率)}
  &=\frac{TP+TN}{TP+FP+TN+FN} \qquad\text{(accuracy)}
\end{align}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>別名 (分野で異なるので注意)
<ul>
<li><p>
感度 (sensitivity) あるいは 再現率 (recall)
</p>
<blockquote>
<div>
\begin{equation}
  \text{(真陽性率)}
  =\frac{TP}{TP+FN}
\end{equation}

</div>
</blockquote></li>
<li><p>
特異度 (specificity)
</p>
<blockquote>
<div>
\begin{equation}
  \text{(真陰性率)}
  =\frac{TN}{FP+TN}
\end{equation}

</div>
</blockquote></li>
<li><p>
精度
</p>
<blockquote>
<div>
\begin{equation}
  \text{(正答率)}
  =\frac{TP+TN}{TP+FP+TN+FN}
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orga2009d2">
<h3 id="orga2009d2">F-値</h3>
<ul>
<li><b>F-measure, F-score</b></li>
<li><p>
定義
</p>
<blockquote>
<div>
\begin{align}
  F_{1}&=\frac{2}{{1}/{\text{(再現率)}}+{1}/{\text{(適合率)}}}\\
  F_{\beta}&=\frac{\beta^{2}+1}{{\beta^{2}}/{\text{(再現率)}}+{1}/{\text{(適合率)}}}
\end{align}

</div>
</blockquote>
<ul>
<li>再現率(真陽性率)と適合率の(重み付き)調和平均</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orga7eab16">
<h3 id="orga7eab16">Cohen の kappa 値</h3>
<ul>
<li>Cohen&rsquo;s <b>kappa measure</b></li>
<li><p>
定義
</p>
<blockquote>
<div>
\begin{align}
  p_{o}
  &=\frac{TP+TN}{TP+FP+TN+FN} \qquad\text{(accuracy)}\\
  p_{e}
  &=\frac{TP+FP}{TP+FP+TN+FN}\cdot\frac{TP+FN}{TP+FP+TN+FN}\\
  &\quad
    +\frac{FN+TN}{TP+FP+TN+FN}\cdot\frac{FP+TN}{TP+FP+TN+FN}\\
  \kappa
  &=
    \frac{p_{o}-p_{e}}{1-p_{e}}
    =
    1-\frac{1-p_{o}}{1-p_{e}}
\end{align}

</div>
</blockquote>
<ul>
<li>観測された精度と偶然の精度の比較</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-orgd47abc6">
<h2 id="orgd47abc6">解析の事例</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orga22edee">
<h3 id="orga22edee">データについて</h3>
<ul>
<li>気象庁より取得した東京の気候データ <br />
<ul>
<li>気象庁 <a href="https://www.data.jma.go.jp/gmd/risk/obsdl/index.php">https://www.data.jma.go.jp/gmd/risk/obsdl/index.php</a></li>
<li>データ <a href="https://noboru-murata.github.io/multivariate-analysis/data/tokyo_weather.csv">https://noboru-murata.github.io/multivariate-analysis/data/tokyo_weather.csv</a></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgdca3a33">
<h3 id="orgdca3a33">気温と湿度による月の判別</h3>
<ul>
<li><p>
温度と湿度による9/10月の線形判別
</p></li>

</ul>


<div id="org9cb956d" class="figure">
<p><img src="figs/09_lda.png" alt="09_lda.png" />
</p>
<p><span class="figure-number">Figure 1: </span>線形判別</p>
</div>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
温度と湿度による9/10月の2次判別
</p></li>

</ul>


<div id="org573da46" class="figure">
<p><img src="figs/09_qda.png" alt="09_qda.png" />
</p>
<p><span class="figure-number">Figure 2: </span>2次判別</p>
</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org2ba54ac">
<h3 id="org2ba54ac">判別結果の比較</h3>
<ul>
<li><p>
線形判別の混同行列
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">予測値＼真値</td>
<td class="org-right">9</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">9</td>
<td class="org-right">27</td>
<td class="org-right">13</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-right">3</td>
<td class="org-right">18</td>
</tr>
</tbody>
</table></li>

<li><p>
2次判別の混同行列
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">予測値＼真値</td>
<td class="org-right">9</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">9</td>
<td class="org-right">27</td>
<td class="org-right">14</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-right">3</td>
<td class="org-right">17</td>
</tr>
</tbody>
</table></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
線形判別の評価指標
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">Accuracy</td>
<td class="org-right">Kappa</td>
</tr>

<tr>
<td class="org-right">0.738</td>
<td class="org-right">0.478</td>
</tr>
</tbody>
</table>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">Sensitivity</td>
<td class="org-right">Specificity</td>
<td class="org-right">Precision</td>
<td class="org-right">Recall</td>
<td class="org-right">F1</td>
</tr>

<tr>
<td class="org-right">0.9</td>
<td class="org-right">0.581</td>
<td class="org-right">0.675</td>
<td class="org-right">0.9</td>
<td class="org-right">0.771</td>
</tr>
</tbody>
</table></li>

<li><p>
2次判別の評価指標
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">Accuracy</td>
<td class="org-right">Kappa</td>
</tr>

<tr>
<td class="org-right">0.721</td>
<td class="org-right">0.446</td>
</tr>
</tbody>
</table>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">Sensitivity</td>
<td class="org-right">Specificity</td>
<td class="org-right">Precision</td>
<td class="org-right">Recall</td>
<td class="org-right">F1</td>
</tr>

<tr>
<td class="org-right">0.9</td>
<td class="org-right">0.548</td>
<td class="org-right">0.659</td>
<td class="org-right">0.9</td>
<td class="org-right">0.761</td>
</tr>
</tbody>
</table></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
テスト
</p>
<!-- html table generated in R 4.2.2 by xtable 1.8-4 package -->
<!-- Mon Nov 21 17:48:23 2022 -->
<table border=1>
<tr> <th>  </th> <th> 9 </th> <th> 10 </th>  </tr>
  <tr> <td align="right"> 9 </td> <td align="right">  27 </td> <td align="right">  14 </td> </tr>
  <tr> <td align="right"> 10 </td> <td align="right">   3 </td> <td align="right">  17 </td> </tr>
   </table></li>

</ul>
<div class="slide-footer"><br></div>



</section>
</section>
<section>
<section id="slide-org03a4dda" data-background="#fef4f4">
<h2 id="org03a4dda">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgef09f15" data-background="#fef4f4">
<h3 id="orgef09f15">問題</h3>
<ul>
<li>以下の問に答えなさい
<ul>
<li>F-値，再現率，適合率の大小関係はどのようになるか</li>
<li>2値判別(\(P=1,N=0\)とする)において
正解ラベル\(Y\)と予測ラベル\(\hat{Y}\)の相関係数を
\(TP,FP,TN,FN\)およびデータ数\(N\)
を用いて表せ</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org4bf1775" data-background="#fef4f4">
<h3 id="org4bf1775">解答例</h3>
<ul>
<li><p>
最大最小と平均の関係から以下が成り立つ
</p>
<blockquote>
<div>
\begin{equation}
  \min(\text{再現率},\text{適合率})
  \le F_{1}
  \le\max(\text{再現率},\text{適合率})
\end{equation}

</div>

<p>
さらに相加・相乗平均の関係から
</p>
<div>
\begin{equation}
  F_{1}
  \le\text{(相乗平均)}
  \le\text{(相加平均)}
\end{equation}

</div>

<p>
も成り立つ
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section data-background="#fef4f4">
<ul>
<li><p>
相関係数の定義に従って計算すればよい
</p>
<blockquote>
<div>
\begin{equation}
  \rho
  =
  \frac{\mathrm{Cov}(Y,\hat{Y})}
  {\sqrt{\mathrm{Var}(Y)\mathrm{Var}(\hat{Y})}}
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section data-background="#fef4f4">
<ul>
<li><p>
例えば分子の共分散は以下のように計算される
</p>
<blockquote>
<div>
\begin{align}
  \mathrm{Cov}(Y,\hat{Y})
  &=
    \mathbb{E}[(Y-\mathbb{E}[Y])(\hat{Y}-\mathbb{E}[\hat{Y}])]\\
  &=
    \mathbb{E}[Y\hat{Y}]-\mathbb{E}[Y]\mathbb{E}[\hat{Y}]\\
  &=
    \frac{TP}{N}-\frac{TP+FN}{N}\frac{TP+FP}{N}\\
  &=
    \frac{TP(TP+FN+FP+TN)}{N^{2}}\\
  &\qquad-
    \frac{(TP+FN)(TP+FP)}{N^{2}}\\
  &=
    \frac{TP\cdot TN - FP\cdot FN}{N^{2}}
\end{align}

</div>
</blockquote>
<ul>
<li>平均は標本平均で置き換えた</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section data-background="#fef4f4">
<ul>
<li><p>
同様に分母の分散は以下のようになる
</p>
<blockquote>
<div>
\begin{align}
  \mathrm{Var}(Y)
  &=
    \mathbb{E}[Y^{2}]-\mathbb{E}[Y]^{2}\\
  &=
    \frac{(TP+FN)(TN+FP)}{N^{2}}\\
  \mathrm{Var}(\hat{Y})
  &=
    \mathbb{E}[\hat{Y}^{2}]-\mathbb{E}[\hat{Y}]^{2}\\
  &=
    \frac{(TP+FP)(TN+FN)}{N^{2}}
\end{align}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section data-background="#fef4f4">
<ul>
<li><p>
したがって以下のようにまとめられる
</p>
<blockquote>
<div>
\begin{equation}
  \rho=
  \frac{TP\cdot TN-FP\cdot FN}
  {\sqrt{(TP+FP)(TP+FN)(TN+FP)(TN+FN)}}       
\end{equation}

</div>
</blockquote>
<ul>
<li>これは Matthews correlation coefficient (MCC)
と呼ばれる評価指標の一つである</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-orgd4fe231" data-background="#fef4f4">
<h2 id="orgd4fe231">実習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org3e93b8a" data-background="#fef4f4">
<h3 id="org3e93b8a">データセットの準備</h3>
<ul>
<li>以下のデータセットを使用します
<ul>
<li><p>
<code>winequality-red.csv</code>
</p>
<blockquote>
<p>
UC Irvine Machine Learning Repository で公開されている
Wine Quality Data Set の一部
</p>
</blockquote>
<p>
<a href="https://archive.ics.uci.edu/ml/datasets/Wine+Quality">https://archive.ics.uci.edu/ml/datasets/Wine+Quality</a>
</p></li>
<li><p>
以下に download せずに読み込む方法を紹介します
</p>
<div class="org-src-container">

<pre><code class="R" >wq_org &lt;- read.csv("https://archive.ics.uci.edu/ml/machine-learning-databases/wine-quality/winequality-red.csv",
                   sep=";") # データの区切りが ";" となっている
wq_data &lt;- transform(wq_org,
                     quality=as.factor( # qualityを再分類
                         ifelse(quality %in% 7:10, "A",
                         ifelse(quality %in% 5:6, "B" ,"C"))))
</code></pre>
</div></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgdf750d0" data-background="#fef4f4">
<h3 id="orgdf750d0">R : 混同行列 <code>caret::confusionMatrix()</code></h3>
<ul>
<li><code>caret</code>: 評価のためのパッケージ</li>
<li><p>
判別結果の評価
</p>
<div class="org-src-container">

<pre><code class="R" >install.packages("caret") # 右下ペインの package タブから install
library(caret) # または require(caret) 
confusionMatrix(data, reference)
## data: 判別関数による予測ラベル (factor)
## referenc: 真のラベル (上と同じfactorである必要がある)
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org7b9fc20" data-background="#fef4f4">
<h3 id="org7b9fc20">練習問題</h3>
<ul>
<li>前回と同様に東京の気候データの線形判別を行い，
以下を確認しなさい
<ul>
<li><p>
10月と11月の気温と湿度のデータを抽出する
</p>
<div class="org-src-container">

<pre><code class="R" >tw_data &lt;- read.csv("data/tokyo_weather.csv")
tw_subset  &lt;- transform(subset(tw_data,
                               subset= month %in% c("10","11"),
                               select=c(temp,humid,month)),
                        month=as.factor(month)) # 因子にする
</code></pre>
</div></li>
<li>全てデータを用いて線形判別関数を構成する</li>
<li>構成した判別関数の評価を行う</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org0f91133" data-background="#fef4f4">
<h3 id="org0f91133">練習問題</h3>
<ul>
<li>Wine Quality Data Set を用いて
以下を確認しなさい
<ul>
<li>全てデータを用いて線形判別関数を構成し，評価を行う</li>
<li>全てデータを用いて2次判別関数を構成し，評価を行う</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-org264cd8a">
<h2 id="org264cd8a">予測誤差</h2>
<div class="outline-text-2" id="text-org264cd8a">
</div>
</section>
<section id="slide-org44164bd">
<h3 id="org44164bd">訓練誤差と予測誤差</h3>
<ul>
<li><b>訓練誤差</b>:
既知データに対する誤り (training error)</li>
<li><b>予測誤差</b>:
未知データに対する誤り (predictive error)</li>
<li>訓練誤差は予測誤差より良くなることが多い</li>
<li>既知データの判別に特化している可能性がある
<ul>
<li>過適応 (over-fitting)</li>
<li>過学習 (over-training)</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orga9e110e">
<h3 id="orga9e110e">交叉検証</h3>
<ul>
<li>データを訓練データと試験データに分割して用いる
<ul>
<li><b>訓練データ</b>:
判別関数を構成する (training data)</li>
<li><b>試験データ</b>:
予測精度を評価する (test data)</li>

</ul></li>
<li>データの分割に依存して予測誤差の評価が偏る</li>
<li>偏りを避けるために複数回分割を行ない評価する</li>
<li>&ldquo;交差&rdquo;と書く場合もある</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org8babe3a">
<h3 id="org8babe3a">交叉検証法</h3>
<ul>
<li><b>cross-validation (CV)</b></li>
<li>\(k\)-重交叉検証法 (\(k\)-fold cross-validation; \(k\)-fold CV)
<ul>
<li>\(n\) 個のデータを \(k\) ブロックにランダムに分割</li>
<li>第 \(i\) ブロックを除いた \(k-1\) ブロックで判別関数を推定</li>
<li>除いておいた第 \(i\) ブロックで予測誤差を評価</li>
<li>\(i=1,\dotsc,k\) で繰り返し \(k\) 個の予測誤差で評価 (平均や分散)</li>

</ul></li>
<li>leave-one-out法 (leave-one-out CV; LOO-CV)
<ul>
<li>\(k=n\) として上記を実行</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-orga762ffa" data-background="#fef4f4">
<h2 id="orga762ffa">実習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgdccf9ab" data-background="#fef4f4">
<h3 id="orgdccf9ab">R : LOO交叉検証法</h3>
<ul>
<li>関数 <code>lda()</code> と <code>qda()</code> はオプションで LOO交叉検証を行うことができる</li>
<li><p>
オプションの指定方法
</p>
<div class="org-src-container">

<pre><code class="R" >est &lt;- lda(formula, data, CV=TRUE)
est$class # LOO CV による予測結果
## 特定のデータを除いて判別関数を構成し，そのデータの予測を行っている
est &lt;- qda(formula, data, CV=TRUE)
est$class # LOO CV による予測結果
## 2次判別についても同様
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org9414837" data-background="#fef4f4">
<h3 id="org9414837">R : k-重交叉検証法 <code>caret::train()</code></h3>
<ul>
<li><p>
<code>caret</code> パッケージの関数 <code>train()</code> で実行可能
</p>
<div class="org-src-container">

<pre><code class="R" >train(formula, data,
      method,
      trControl=trainControl(method="cv", number))
## formula: Rの式 
## data: データフレーム
## method: 推定を行う関数 method="lda"/"qda" などを指定
## trControl: 学習方法の指定
## trainControl のオプション
##  method: 評価方法など指定 method="cv"/"LOOCV"
##  number: k-重交叉検証のブロック数 (k)
</code></pre>
</div></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orge178e95" data-background="#fef4f4">
<h3 id="orge178e95">練習問題</h3>
<ul>
<li>Wine Quality Data Set を用いた
線形判別と2次判別に関して，以下を行いなさい
<ul>
<li>LOO交叉検証法を用いて予測誤差の評価を行いなさい</li>
<li>k-重交叉検証法を用いて予測誤差の評価を行いなさい</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-orgf91f986">
<h2 id="orgf91f986">解析の事例</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org3b345e2">
<h3 id="org3b345e2">データについて</h3>
<ul>
<li>UC Irvine Machine Learning Repository の公開データ
<ul>
<li><p>
<a href="https://archive.ics.uci.edu/ml/datasets/Wine+Quality">https://archive.ics.uci.edu/ml/datasets/Wine+Quality</a>
</p>
<blockquote>
<p>
Wine Quality Data Set
</p>

<p>
P. Cortez, A. Cerdeira, F. Almeida, T. Matos and J. Reis. 
Modeling wine preferences by data mining from physicochemical properties.
In Decision Support Systems, Elsevier, 47(4):547-553. ISSN: 0167-9236.
</p>
</blockquote>
<p>
以下では <code>winequality-red.csv</code> を利用
</p></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>データ概要
<ul>
<li>データ数 1599</li>
<li><p>
説明変数 (based on physicochemical tests)
</p>
<blockquote>
<p>
1 - fixed acidity <br />
2 - volatile acidity <br />
3 - citric acid <br />
4 - residual sugar <br />
5 - chlorides <br />
6 - free sulfur dioxide <br />
7 - total sulfur dioxide <br />
8 - density <br />
9 - pH <br />
10 - sulphates <br />
11 - alcohol <br />
</p>
</blockquote></li>
<li><p>
目的変数  (based on sensory data)
</p>
<blockquote>
<p>
12 - quality (score between 0 and 10) <br />
</p>
</blockquote>
<ul>
<li>ただし解析では A,B,C の3値に集計</li>

</ul></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
実際のデータの一部
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">7.4</td>
<td class="org-right">0.7</td>
<td class="org-right">0</td>
<td class="org-right">1.9</td>
</tr>

<tr>
<td class="org-right">7.8</td>
<td class="org-right">0.88</td>
<td class="org-right">0</td>
<td class="org-right">2.6</td>
</tr>

<tr>
<td class="org-right">7.8</td>
<td class="org-right">0.76</td>
<td class="org-right">0.04</td>
<td class="org-right">2.3</td>
</tr>

<tr>
<td class="org-right">11.2</td>
<td class="org-right">0.28</td>
<td class="org-right">0.56</td>
<td class="org-right">1.9</td>
</tr>

<tr>
<td class="org-right">7.4</td>
<td class="org-right">0.7</td>
<td class="org-right">0</td>
<td class="org-right">1.9</td>
</tr>

<tr>
<td class="org-right">7.4</td>
<td class="org-right">0.66</td>
<td class="org-right">0</td>
<td class="org-right">1.8</td>
</tr>

<tr>
<td class="org-right">7.9</td>
<td class="org-right">0.6</td>
<td class="org-right">0.06</td>
<td class="org-right">1.6</td>
</tr>

<tr>
<td class="org-right">7.3</td>
<td class="org-right">0.65</td>
<td class="org-right">0</td>
<td class="org-right">1.2</td>
</tr>

<tr>
<td class="org-right">7.8</td>
<td class="org-right">0.58</td>
<td class="org-right">0.02</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-right">7.5</td>
<td class="org-right">0.5</td>
<td class="org-right">0.36</td>
<td class="org-right">6.1</td>
</tr>

<tr>
<td class="org-right">6.7</td>
<td class="org-right">0.58</td>
<td class="org-right">0.08</td>
<td class="org-right">1.8</td>
</tr>

<tr>
<td class="org-right">7.5</td>
<td class="org-right">0.5</td>
<td class="org-right">0.36</td>
<td class="org-right">6.1</td>
</tr>

<tr>
<td class="org-right">5.6</td>
<td class="org-right">0.615</td>
<td class="org-right">0</td>
<td class="org-right">1.6</td>
</tr>

<tr>
<td class="org-right">7.8</td>
<td class="org-right">0.61</td>
<td class="org-right">0.29</td>
<td class="org-right">1.6</td>
</tr>

<tr>
<td class="org-right">8.9</td>
<td class="org-right">0.62</td>
<td class="org-right">0.18</td>
<td class="org-right">3.8</td>
</tr>

<tr>
<td class="org-right">8.9</td>
<td class="org-right">0.62</td>
<td class="org-right">0.19</td>
<td class="org-right">3.9</td>
</tr>
</tbody>
</table></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
実際のデータの一部 (続き)
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">0.076</td>
<td class="org-right">11</td>
<td class="org-right">34</td>
<td class="org-right">0.9978</td>
</tr>

<tr>
<td class="org-right">0.098</td>
<td class="org-right">25</td>
<td class="org-right">67</td>
<td class="org-right">0.9968</td>
</tr>

<tr>
<td class="org-right">0.092</td>
<td class="org-right">15</td>
<td class="org-right">54</td>
<td class="org-right">0.997</td>
</tr>

<tr>
<td class="org-right">0.075</td>
<td class="org-right">17</td>
<td class="org-right">60</td>
<td class="org-right">0.998</td>
</tr>

<tr>
<td class="org-right">0.076</td>
<td class="org-right">11</td>
<td class="org-right">34</td>
<td class="org-right">0.9978</td>
</tr>

<tr>
<td class="org-right">0.075</td>
<td class="org-right">13</td>
<td class="org-right">40</td>
<td class="org-right">0.9978</td>
</tr>

<tr>
<td class="org-right">0.069</td>
<td class="org-right">15</td>
<td class="org-right">59</td>
<td class="org-right">0.9964</td>
</tr>

<tr>
<td class="org-right">0.065</td>
<td class="org-right">15</td>
<td class="org-right">21</td>
<td class="org-right">0.9946</td>
</tr>

<tr>
<td class="org-right">0.073</td>
<td class="org-right">9</td>
<td class="org-right">18</td>
<td class="org-right">0.9968</td>
</tr>

<tr>
<td class="org-right">0.071</td>
<td class="org-right">17</td>
<td class="org-right">102</td>
<td class="org-right">0.9978</td>
</tr>

<tr>
<td class="org-right">0.097</td>
<td class="org-right">15</td>
<td class="org-right">65</td>
<td class="org-right">0.9959</td>
</tr>

<tr>
<td class="org-right">0.071</td>
<td class="org-right">17</td>
<td class="org-right">102</td>
<td class="org-right">0.9978</td>
</tr>

<tr>
<td class="org-right">0.089</td>
<td class="org-right">16</td>
<td class="org-right">59</td>
<td class="org-right">0.9943</td>
</tr>

<tr>
<td class="org-right">0.114</td>
<td class="org-right">9</td>
<td class="org-right">29</td>
<td class="org-right">0.9974</td>
</tr>

<tr>
<td class="org-right">0.176</td>
<td class="org-right">52</td>
<td class="org-right">145</td>
<td class="org-right">0.9986</td>
</tr>

<tr>
<td class="org-right">0.17</td>
<td class="org-right">51</td>
<td class="org-right">148</td>
<td class="org-right">0.9986</td>
</tr>
</tbody>
</table></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
実際のデータの一部 (続き) 
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">3.51</td>
<td class="org-right">0.56</td>
<td class="org-right">9.4</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-right">3.2</td>
<td class="org-right">0.68</td>
<td class="org-right">9.8</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-right">3.26</td>
<td class="org-right">0.65</td>
<td class="org-right">9.8</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-right">3.16</td>
<td class="org-right">0.58</td>
<td class="org-right">9.8</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-right">3.51</td>
<td class="org-right">0.56</td>
<td class="org-right">9.4</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-right">3.51</td>
<td class="org-right">0.56</td>
<td class="org-right">9.4</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-right">3.3</td>
<td class="org-right">0.46</td>
<td class="org-right">9.4</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-right">3.39</td>
<td class="org-right">0.47</td>
<td class="org-right">10</td>
<td class="org-left">A</td>
</tr>

<tr>
<td class="org-right">3.36</td>
<td class="org-right">0.57</td>
<td class="org-right">9.5</td>
<td class="org-left">A</td>
</tr>

<tr>
<td class="org-right">3.35</td>
<td class="org-right">0.8</td>
<td class="org-right">10.5</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-right">3.28</td>
<td class="org-right">0.54</td>
<td class="org-right">9.2</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-right">3.35</td>
<td class="org-right">0.8</td>
<td class="org-right">10.5</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-right">3.58</td>
<td class="org-right">0.52</td>
<td class="org-right">9.9</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-right">3.26</td>
<td class="org-right">1.56</td>
<td class="org-right">9.1</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-right">3.16</td>
<td class="org-right">0.88</td>
<td class="org-right">9.2</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-right">3.17</td>
<td class="org-right">0.93</td>
<td class="org-right">9.2</td>
<td class="org-left">B</td>
</tr>
</tbody>
</table></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org7964ee9">
<h3 id="org7964ee9">LOO交叉検証による予測誤差の評価</h3>
<ul>
<li><p>
線形判別 (訓練誤差/予測誤差)
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">83</td>
<td class="org-right">65</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-right">134</td>
<td class="org-right">1239</td>
<td class="org-right">55</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-right">15</td>
<td class="org-right">6</td>
</tr>
</tbody>
</table>

<ul>
<li>線形判別の過学習は微小</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
2次判別 (訓練誤差/予測誤差)
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">120</td>
<td class="org-right">141</td>
<td class="org-right">4</td>
</tr>

<tr>
<td class="org-right">96</td>
<td class="org-right">1133</td>
<td class="org-right">50</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">45</td>
<td class="org-right">9</td>
</tr>
</tbody>
</table>

<ul>
<li>2次判別は若干過学習している</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
予測誤差の比較 (線形/2次)
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">0.382488479262673</td>
<td class="org-right">0.951519536903039</td>
<td class="org-right">0.553333333333333</td>
<td class="org-right">0.382488479262673</td>
<td class="org-right">0.452316076294278</td>
</tr>

<tr>
<td class="org-right">0.939347990902199</td>
<td class="org-right">0.325</td>
<td class="org-right">0.867647058823529</td>
<td class="org-right">0.939347990902199</td>
<td class="org-right">0.902074990899163</td>
</tr>

<tr>
<td class="org-right">0.0952380952380952</td>
<td class="org-right">0.990234375</td>
<td class="org-right">0.285714285714286</td>
<td class="org-right">0.0952380952380952</td>
<td class="org-right">0.142857142857143</td>
</tr>
</tbody>
</table>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">0.552995391705069</td>
<td class="org-right">0.895079594790159</td>
<td class="org-right">0.452830188679245</td>
<td class="org-right">0.552995391705069</td>
<td class="org-right">0.49792531120332</td>
</tr>

<tr>
<td class="org-right">0.858984078847612</td>
<td class="org-right">0.478571428571429</td>
<td class="org-right">0.885848318999218</td>
<td class="org-right">0.858984078847612</td>
<td class="org-right">0.872209391839877</td>
</tr>

<tr>
<td class="org-right">0.142857142857143</td>
<td class="org-right">0.970052083333333</td>
<td class="org-right">0.163636363636364</td>
<td class="org-right">0.142857142857143</td>
<td class="org-right">0.152542372881356</td>
</tr>
</tbody>
</table>

<ul>
<li>予測誤差の観点からは線形判別の方が良さそう</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org0e49a49">
<h2 id="org0e49a49">次週の予定</h2>
<ul>
<li><b>第1日 : クラスタ分析の考え方と階層的方法</b></li>
<li>第2日 : 非階層的方法と分析の評価</li>

</ul>
<div class="slide-footer"><br></div>
</div>
</div>
<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/search/search.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script src="./reveal.js/plugin/highlight/highlight.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,
overview: true,

transition: 'fade',
transitionSpeed: 'default',
spotlight: { size: 90, initialPresentationMode: false }, chalkboard: { toggleChalkboardButton: { left: '80px' }, toggleNotesButton: { left: '130px'}}, keyboard: { 69: function() { RevealChalkboard.toggleNotesCanvas() }, 87: function() { RevealChalkboard.toggleChalkboard() }, 67: function() { RevealChalkboard.clear() }, 82: function() { RevealChalkboard.reset() }, 68: function() { RevealChalkboard.download() }, 88: function() { RevealChalkboard.colorNext() }, 89: function() { RevealChalkboard.colorPrev() }, 84: function() { RevealSpotlight.toggleSpotlight() }, 81: function() { RevealSpotlight.togglePresentationMode()}},

// Plugins with reveal.js 4.x
plugins: [ RevealNotes, RevealSearch, RevealZoom, RevealHighlight ],

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/menu/menu.js'},
{ src: './reveal.js/plugin/chalkboard/chalkboard.js'},
{ src: './reveal.js/plugin/spotlight/spotlight.js'}]

});
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>判別分析</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/fonts/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/mycourse.css"/>
<link rel="stylesheet" href="./reveal.js/plugin/highlight/zenburn.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">判別分析</h1>
</div>
<div class="talk-subtitle">
    <p>分析の評価</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  </p>
</div>

</section>

<section>
<section id="slide-org428c12c">
<h2 id="org428c12c">講義の内容</h2>
<ul>
<li>第1日: 判別分析の考え方</li>
<li><b>第2日: 分析の評価</b></li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-org43383c5">
<h2 id="org43383c5">判別分析の復習</h2>
<div class="outline-text-2" id="text-org43383c5">
</div>
</section>
<section id="slide-org748c13b">
<h3 id="org748c13b">判別分析</h3>
<ul>
<li>個体の特徴量から
その個体の属するクラスを予測する関係式を構成</li>
<li><b>事前確率</b>: \(\pi_k=P(Y=k)\) (prior probability)
<ul>
<li>\(X=\boldsymbol{x}\) が与えられる前に予測されるクラス</li>

</ul></li>
<li><b>事後確率</b>: \(p_k(\boldsymbol{x})\) (posterior probability)
<ul>
<li><p>
\(X=\boldsymbol{x}\) が与えられた後に予測されるクラス
</p>
<blockquote>
<div>
\begin{equation}
  p_k(\boldsymbol{x}):=P(Y=k|X=\boldsymbol{x})
\end{equation}

</div>
</blockquote></li>
<li>所属する確率が最も高いクラスに個体を分類</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org2317234">
<h3 id="org2317234">判別関数</h3>
<ul>
<li>判別の手続き
<ul>
<li>説明変数 \(X=\boldsymbol{x}\) の取得</li>
<li>事後確率 \(p_k(\boldsymbol{x})\) の計算</li>
<li>事後確率最大のクラスにデータを分類</li>

</ul></li>
<li><p>
<b>判別関数</b>: \(\delta_k(\boldsymbol{x})\) (\(k=1,\dots,K\))
</p>
<blockquote>
<div>
\begin{equation}
  p_k(\boldsymbol{x}) 
  < 
  p_l(\boldsymbol{x})
  \Leftrightarrow
  \delta_k(\boldsymbol{x})
  <
  \delta_l(\boldsymbol{x})
\end{equation}

</div>
</blockquote>
<p>
事後確率の順序を保存する計算しやすい関数
</p></li>
<li>判別関数 \(\delta_k(\boldsymbol{x})\) を最大化するようなクラス \(k\) に分類</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org1c9ad22">
<h3 id="org1c9ad22">線形判別</h3>
<ul>
<li>\(f_k(\boldsymbol{x})\) の仮定:
<ul>
<li>\(q\) 変量正規分布の密度関数</li>
<li>平均ベクトル \(\boldsymbol{\mu}_k\): クラスごとに異なる</li>
<li><p>
共分散行列 \(\Sigma\): <b>すべてのクラスで共通</b>
</p>
<blockquote>
<div>
\begin{equation}
  f_k(\boldsymbol{x})
  =
  \frac{1}{(2\pi)^{q/2}\sqrt{\det\Sigma}}
  \exp\left(-\frac{1}{2}(\boldsymbol{x}-\boldsymbol{\mu}_k)^{\mathsf{T}}
    \Sigma^{-1}(\boldsymbol{x}-\boldsymbol{\mu}_k)\right)
\end{equation}

</div>
</blockquote></li>

</ul></li>
<li><p>
線形判別関数: \(\boldsymbol{x}\) の1次式
</p>

<blockquote>
<div>
\begin{equation}
  \delta_k(\boldsymbol{x})
  =
  \boldsymbol{x}^{\mathsf{T}}\Sigma^{-1}\boldsymbol{\mu}_k
  -\frac{1}{2}\boldsymbol{\mu}_k^{\mathsf{T}}\Sigma^{-1}\boldsymbol{\mu}_k
  +\log\pi_k
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgf3f9cc5">
<h3 id="orgf3f9cc5">2次判別</h3>
<ul>
<li>\(f_k(\boldsymbol{x})\) の仮定:
<ul>
<li>\(q\) 変量正規分布の密度関数</li>
<li>平均ベクトル \(\boldsymbol{\mu}_k\): クラスごとに異なる</li>
<li><p>
共分散行列 \(\Sigma_k\): <b>クラスごとに異なる</b>
</p>
<blockquote>
<div>
\begin{equation}
  f_k(\boldsymbol{x})
  =
  \frac{1}{(2\pi)^{q/2}\sqrt{\det\Sigma_k}}
  \exp\left(-\frac{1}{2}(\boldsymbol{x}-\boldsymbol{\mu}_k)^{\mathsf{T}}
    \Sigma_k^{-1}(\boldsymbol{x}-\boldsymbol{\mu}_k)\right)
\end{equation}

</div>
</blockquote></li>

</ul></li>
<li><p>
2次判別関数: \(\boldsymbol{x}\) の2次式
</p>
<blockquote>
<div>
\begin{equation}
  \delta_k(\boldsymbol{x})
  =
  -\frac{1}{2}\det\Sigma_k
  -\frac{1}{2}(\boldsymbol{x}-\boldsymbol{\mu}_k)^{\mathsf{T}}
  \Sigma_k^{-1}(\boldsymbol{x}-\boldsymbol{\mu}_k)
  +\log\pi_k
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgbd7c276">
<h3 id="orgbd7c276">Fisherの線形判別</h3>
<ul>
<li>新しい特徴量 \(Z=\boldsymbol{\alpha}^{\mathsf{T}} X\) を考える</li>
<li>良い \(Z\) の基準:
<ul>
<li>クラス内では集まっているほど良い (\(\boldsymbol{\alpha}^{\mathsf{T}} W\boldsymbol{\alpha}\)は小)</li>
<li>クラス間では離れているほど良い (\(\boldsymbol{\alpha}^{\mathsf{T}} B\boldsymbol{\alpha}\)は大)</li>

</ul></li>
<li><p>
Fisherの基準:
</p>
<blockquote>
<div>
\begin{equation}
  \text{maximize}\quad \boldsymbol{\alpha}^{\mathsf{T}} B\boldsymbol{\alpha}
  \quad\text{s.t.}\quad \boldsymbol{\alpha}^{\mathsf{T}} W\boldsymbol{\alpha}=\text{const.}
\end{equation}

</div>
</blockquote>
<ul>
<li>\(\boldsymbol{\alpha}\) は \(W^{-1}B\) の第1から第 \(K-1\) 固有ベクトル</li>
<li>判別方法: 特徴量の距離を用いる</li>
<li>\(d_{k}=\sum_{l=1}^{K-1}(\alpha_l^{\mathsf{T}}\boldsymbol{x}-\alpha_l^{\mathsf{T}}\mu_k)^2\) 
が最小のとなるクラス \(k\) に判別</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-orged373a5">
<h2 id="orged373a5">2値判別分析の評価</h2>
<div class="outline-text-2" id="text-orged373a5">
</div>
</section>
<section id="slide-orge6ca6dd">
<h3 id="orge6ca6dd">誤り率</h3>
<ul>
<li><p>
単純な誤り:
</p>
<blockquote>
<div>
\begin{equation}
  \text{(誤り率)}
  =\frac{\text{(誤って判別されたデータ数)}}
  {\text{(全データ数)}}
\end{equation}

</div>
</blockquote></li>
<li>判別したいラベル: 陽性 (positive)
<ul>
<li><b>真陽性</b>: 正しく陽性と判定 (true positive; TP)</li>
<li><b>偽陽性</b>: 誤って陽性と判定 (false positive; FP) (<b>第I種過誤</b>)</li>
<li><b>偽陰性</b>: 誤って陰性と判定 (false negative; FN) (<b>第II種過誤</b>)</li>
<li><b>真陰性</b>: 正しく陰性と判定 (true negative; TN)</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgb0e09e4">
<h3 id="orgb0e09e4">混同行列</h3>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">真値は陽性</th>
<th scope="col" class="org-left">真値は陰性</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">判別は陽性</td>
<td class="org-left">真陽性 (True Positive)</td>
<td class="org-left">偽陽性 (False Positive)</td>
</tr>

<tr>
<td class="org-left">判別は陰性</td>
<td class="org-left">偽陰性 (False Negative)</td>
<td class="org-left">真陰性 (True Negative)</td>
</tr>
</tbody>
</table>
<ul>
<li><b>confusion matrix</b></li>
<li>転置で書く流儀もあるので注意</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org2aebe22">
<h3 id="org2aebe22">混同行列</h3>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">判別は陽性</th>
<th scope="col" class="org-left">判別は陰性</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">真値は陽性</td>
<td class="org-left">真陽性 (True Positive)</td>
<td class="org-left">偽陰性 (False Negative)</td>
</tr>

<tr>
<td class="org-left">真値は陰性</td>
<td class="org-left">偽陽性 (False Positive)</td>
<td class="org-left">真陰性 (True Negative)</td>
</tr>
</tbody>
</table>
<ul>
<li>パターン認識や機械学習で多く見られた書き方</li>
<li>誤差行列 (error matrix) とも呼ばれる</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org8e3eebb">
<h3 id="org8e3eebb">基本的な評価基準</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<div>
\begin{align}
  \text{(真陽性率)}
  &=\frac{TP}{TP+FN} \qquad\text{(true positive rate)}\\
  \text{(真陰性率)}
  &=\frac{TN}{FP+TN} \qquad\text{(true negative rate)}\\
  \text{(適合率)}
  &=\frac{TP}{TP+FP} \qquad\text{(precision)}\\
  \text{(正答率)}
  &=\frac{TP+TN}{TP+FP+TN+FN} \qquad\text{(accuracy)}
\end{align}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>別名 (分野で異なるので注意)
<ul>
<li><p>
感度 (sensitivity) あるいは 再現率 (recall):
</p>
<blockquote>
<div>
\begin{equation}
  \text{(真陽性率)}
  =\frac{TP}{TP+FN}
\end{equation}

</div>
</blockquote></li>
<li><p>
特異度 (specificity):
</p>
<blockquote>
<div>
\begin{equation}
  \text{(真陰性率)}
  =\frac{TN}{FP+TN}
\end{equation}

</div>
</blockquote></li>
<li><p>
精度:
</p>
<blockquote>
<div>
\begin{equation}
  \text{(正答率)}
  =\frac{TP+TN}{TP+FP+TN+FN}
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org3d4deb4">
<h3 id="org3d4deb4">F-値</h3>
<ul>
<li><b>F-measure, F-score</b></li>
<li><p>
定義
</p>
<blockquote>
<div>
\begin{align}
  F_{1}&=\frac{2}{{1}/{\text{(再現率)}}+{1}/{\text{(適合率)}}}\\
  F_{\beta}&=\frac{\beta^{2}+1}{{\beta^{2}}/{\text{((再現率)}}+{1}/{\text{(適合率)}}}
\end{align}

</div>
</blockquote>
<ul>
<li>再現率(真陽性率)と適合率の(重み付き)調和平均</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgdd4d5ad">
<h3 id="orgdd4d5ad">Cohen の kappa 値</h3>
<ul>
<li>Cohen&rsquo;s <b>kappa measure</b></li>
<li><p>
定義
</p>
<blockquote>
<div>
\begin{align}
  p_{o}
  &=\frac{TP+TN}{TP+FP+TN+FN} \qquad\text{(accuracy)}\\
  p_{e}
  &=\frac{TP+FP}{TP+FP+TN+FN}\cdot\frac{TP+FN}{TP+FP+TN+FN}\\
  &\quad
    +\frac{FN+TN}{TP+FP+TN+FN}\cdot\frac{FP+TN}{TP+FP+TN+FN}\\
  \kappa
  &=
    \frac{p_{o}-p_{e}}{1-p_{e}}
    =
    1-\frac{1-p_{o}}{1-p_{e}}
\end{align}

</div>
</blockquote>
<ul>
<li>観測された精度と偶然の精度の比較</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-orgc02fd73">
<h2 id="orgc02fd73">解析の事例</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org5aba76c">
<h3 id="org5aba76c">データについて</h3>
<ul>
<li>気象庁より取得した東京の気候データ <br />
<ul>
<li>気象庁 <a href="https://www.data.jma.go.jp/gmd/risk/obsdl/index.php">https://www.data.jma.go.jp/gmd/risk/obsdl/index.php</a></li>
<li>データ <a href="https://noboru-murata.github.io/multivariate-analysis/data/tokyo_weather.csv">https://noboru-murata.github.io/multivariate-analysis/data/tokyo_weather.csv</a></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org9e305d0">
<h3 id="org9e305d0">気温と湿度による月の判別</h3>
<ul>
<li><p>
温度と湿度による9/10月の線形判別
</p></li>

</ul>


<div id="orgf82fc2f" class="figure">
<p><img src="figs/09_lda.png" alt="09_lda.png" />
</p>
<p><span class="figure-number">Figure 1: </span>線形判別</p>
</div>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
温度と湿度による9/10月の2次判別
</p></li>

</ul>


<div id="org937f746" class="figure">
<p><img src="figs/09_qda.png" alt="09_qda.png" />
</p>
<p><span class="figure-number">Figure 2: </span>2次判別</p>
</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org22415c0">
<h3 id="org22415c0">判別結果の比較</h3>
<ul>
<li><p>
線形判別の混同行列
</p>
<pre class="example">
          Reference
Prediction  9 10
        9  24  6
        10  6 25
</pre></li>

<li><p>
2次判別の混同行列
</p>
<pre class="example">
          Reference
Prediction  9 10
        9  25  6
        10  5 25
</pre>


<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
線形判別の評価指標
</p>
<pre class="example">
 Accuracy     Kappa 
0.8032787 0.6064516
Sensitivity Specificity   Precision      Recall          F1 
  0.8000000   0.8064516   0.8000000   0.8000000   0.8000000
</pre></li>

<li><p>
2次判別の評価指標
</p>
<pre class="example">
 Accuracy     Kappa 
0.8196721 0.6394412
Sensitivity Specificity   Precision      Recall          F1 
  0.8333333   0.8064516   0.8064516   0.8333333   0.8196721
</pre></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org5760f2b" data-background="#fef4f4">
<h2 id="org5760f2b">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgabd5c13" data-background="#fef4f4">
<h3 id="orgabd5c13">問題</h3>
<ul>
<li>以下の問に答えなさい
<ul>
<li>F-値，再現率，適合率の大小関係はどのようになるか</li>
<li>2値判別(\(P=1,N=0\)とする)において
正解ラベル\(Y\)と予測ラベル\(\hat{Y}\)の相関係数を
\(TP,FP,TN,FN\)およびデータ数\(N\)
を用いて表せ</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-org3aa7246">
<h2 id="org3aa7246">予測誤差</h2>
<div class="outline-text-2" id="text-org3aa7246">
</div>
</section>
<section id="slide-org5931fae">
<h3 id="org5931fae">訓練誤差と予測誤差</h3>
<ul>
<li><b>訓練誤差</b>:
既知データに対する誤り (training error)</li>
<li><b>予測誤差</b>:
未知データに対する誤り (predictive error)</li>
<li>訓練誤差は予測誤差より良くなることが多い</li>
<li>既知データの判別に特化している可能性がある
<ul>
<li>過適応 (over-fitting)</li>
<li>過学習 (over-training)</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orge326ab3">
<h3 id="orge326ab3">交叉検証</h3>
<ul>
<li>データを訓練データと試験データに分割して用いる
<ul>
<li><b>訓練データ</b>:
判別関数を構成する (training data)</li>
<li><b>試験データ</b>:
予測精度を評価する (test data)</li>

</ul></li>
<li>データの分割に依存して予測誤差の評価が偏る</li>
<li>偏りを避けるために複数回分割を行ない評価する</li>
<li>&ldquo;交差&rdquo;と書く場合もある</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgd1337ac">
<h3 id="orgd1337ac">交叉検証法</h3>
<ul>
<li><b>cross-validation (CV)</b></li>
<li>\(k\)-重交叉検証法 (\(k\)-fold cross-validation; \(k\)-fold CV)
<ul>
<li>\(n\) 個のデータを \(k\) ブロックにランダムに分割</li>
<li>第 \(i\) ブロックを除いた \(k-1\) ブロックで判別関数を推定</li>
<li>除いておいた第 \(i\) ブロックで予測誤差を評価</li>
<li>\(i=1,\dotsc,k\) で繰り返し \(k\) 個の予測誤差で評価 (平均や分散)</li>

</ul></li>
<li>leave-one-out法 (leave-one-out CV; LOO-CV)
<ul>
<li>\(k=n\) として上記を実行</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org6aaba6d">
<h2 id="org6aaba6d">解析の事例</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org5c6a331">
<h3 id="org5c6a331">データについて</h3>
<ul>
<li>UC Irvine Machine Learning Repository の公開データ
<ul>
<li><p>
<a href="https://archive.ics.uci.edu/ml/datasets/Wine+Quality">https://archive.ics.uci.edu/ml/datasets/Wine+Quality</a>
</p>
<blockquote>
<p>
Wine Quality Data Set
</p>

<p>
P. Cortez, A. Cerdeira, F. Almeida, T. Matos and J. Reis. 
Modeling wine preferences by data mining from physicochemical properties.
In Decision Support Systems, Elsevier, 47(4):547-553. ISSN: 0167-9236.
</p>
</blockquote>
<p>
以下では <code>winequality-red.csv</code> を利用
</p></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>データ概要
<ul>
<li>データ数 1599</li>
<li><p>
説明変数 (based on physicochemical tests)
</p>
<blockquote>
<p>
1 - fixed acidity <br />
2 - volatile acidity <br />
3 - citric acid <br />
4 - residual sugar <br />
5 - chlorides <br />
6 - free sulfur dioxide <br />
7 - total sulfur dioxide <br />
8 - density <br />
9 - pH <br />
10 - sulphates <br />
11 - alcohol <br />
</p>
</blockquote></li>
<li><p>
目的変数  (based on sensory data)
</p>
<blockquote>
<p>
12 - quality (score between 0 and 10) <br />
</p>
</blockquote>
<ul>
<li>ただし解析では A,B,C の3値に集計</li>

</ul></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
実際のデータの一部
</p>
<pre class="example" id="org94a1f7a">
   fixed.acidity volatile.acidity citric.acid residual.sugar
1            7.4            0.700        0.00            1.9
2            7.8            0.880        0.00            2.6
3            7.8            0.760        0.04            2.3
4           11.2            0.280        0.56            1.9
5            7.4            0.700        0.00            1.9
6            7.4            0.660        0.00            1.8
7            7.9            0.600        0.06            1.6
8            7.3            0.650        0.00            1.2
9            7.8            0.580        0.02            2.0
10           7.5            0.500        0.36            6.1
11           6.7            0.580        0.08            1.8
12           7.5            0.500        0.36            6.1
13           5.6            0.615        0.00            1.6
14           7.8            0.610        0.29            1.6
15           8.9            0.620        0.18            3.8
16           8.9            0.620        0.19            3.9
</pre></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
実際のデータの一部 (続き)
</p>
<pre class="example" id="org935c515">
   chlorides free.sulfur.dioxide total.sulfur.dioxide density
1      0.076                  11                   34  0.9978
2      0.098                  25                   67  0.9968
3      0.092                  15                   54  0.9970
4      0.075                  17                   60  0.9980
5      0.076                  11                   34  0.9978
6      0.075                  13                   40  0.9978
7      0.069                  15                   59  0.9964
8      0.065                  15                   21  0.9946
9      0.073                   9                   18  0.9968
10     0.071                  17                  102  0.9978
11     0.097                  15                   65  0.9959
12     0.071                  17                  102  0.9978
13     0.089                  16                   59  0.9943
14     0.114                   9                   29  0.9974
15     0.176                  52                  145  0.9986
16     0.170                  51                  148  0.9986
</pre></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
実際のデータの一部 (続き) 
</p>
<pre class="example" id="org9e351cc">
     pH sulphates alcohol quality
1  3.51      0.56     9.4       B
2  3.20      0.68     9.8       B
3  3.26      0.65     9.8       B
4  3.16      0.58     9.8       B
5  3.51      0.56     9.4       B
6  3.51      0.56     9.4       B
7  3.30      0.46     9.4       B
8  3.39      0.47    10.0       A
9  3.36      0.57     9.5       A
10 3.35      0.80    10.5       B
11 3.28      0.54     9.2       B
12 3.35      0.80    10.5       B
13 3.58      0.52     9.9       B
14 3.26      1.56     9.1       B
15 3.16      0.88     9.2       B
16 3.17      0.93     9.2       B
</pre></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orge8a0e4c">
<h3 id="orge8a0e4c">LOO交叉検証による予測誤差の評価</h3>
<ul>
<li><p>
線形判別 (訓練誤差/予測誤差)
</p>
<pre class="example" id="orgecb9ec9">
	  Reference
Prediction    A    B    C
	 A   85   64    2
	 B  132 1242   53
	 C    0   13    8
	  Reference
Prediction    A    B    C
	 A   83   65    2
	 B  134 1239   55
	 C    0   15    6
</pre>

<ul>
<li>線形判別の過学習は微小</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
2次判別 (訓練誤差/予測誤差)
</p>
<pre class="example" id="org6bbf778">
	  Reference
Prediction    A    B    C
	 A  139  138    2
	 B   77 1138   46
	 C    1   43   15
	  Reference
Prediction    A    B    C
	 A  120  141    4
	 B   96 1133   50
	 C    1   45    9
</pre>

<ul>
<li>2次判別は若干過学習している</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
予測誤差の比較 (線形/2次)
</p>
<pre class="example">
 Accuracy     Kappa 
0.8305191 0.3222838
         Sensitivity Specificity Precision    Recall        F1
Class: A   0.3824885   0.9515195 0.5533333 0.3824885 0.4523161
Class: B   0.9393480   0.3250000 0.8676471 0.9393480 0.9020750
Class: C   0.0952381   0.9902344 0.2857143 0.0952381 0.1428571
</pre>


<pre class="example">
 Accuracy     Kappa 
0.7892433 0.3337747
         Sensitivity Specificity Precision    Recall        F1
Class: A   0.5529954   0.8950796 0.4528302 0.5529954 0.4979253
Class: B   0.8589841   0.4785714 0.8858483 0.8589841 0.8722094
Class: C   0.1428571   0.9700521 0.1636364 0.1428571 0.1525424
</pre>


<ul>
<li>予測誤差の観点からは線形判別の方が良さそう</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org4e4468f">
<h2 id="org4e4468f">次週の予定</h2>
<ul>
<li><b>第1日: クラスタ分析の考え方と階層的方法</b></li>
<li>第2日: 非階層的方法と分析の評価</li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
</div>
</div>
<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/search/search.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script src="./reveal.js/plugin/highlight/highlight.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,
overview: true,

transition: 'fade',
transitionSpeed: 'default',
spotlight: { size: 90, initialPresentationMode: false }, chalkboard: { toggleChalkboardButton: { left: '80px' }, toggleNotesButton: { left: '130px'}}, keyboard: { 69: function() { RevealChalkboard.toggleNotesCanvas() }, 87: function() { RevealChalkboard.toggleChalkboard() }, 67: function() { RevealChalkboard.clear() }, 82: function() { RevealChalkboard.reset() }, 68: function() { RevealChalkboard.download() }, 88: function() { RevealChalkboard.colorNext() }, 89: function() { RevealChalkboard.colorPrev() }, 84: function() { RevealSpotlight.toggleSpotlight() }, 81: function() { RevealSpotlight.togglePresentationMode()}},

// Plugins with reveal.js 4.x
plugins: [ RevealNotes, RevealSearch, RevealZoom, RevealHighlight ],

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/menu/menu.js'},
{ src: './reveal.js/plugin/chalkboard/chalkboard.js'},
{ src: './reveal.js/plugin/spotlight/spotlight.js'}]

});
</script>
</body>
</html>
